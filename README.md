# PCで学ぶ！Python音声処理入門

## 1. はじめに

このドキュメントは、特別なハードウェアを使わず、お手元のPC（Windows）とPythonを使って音声処理の基本を学ぶための入門ガイドです。マイクからの録音、スピーカーでの再生、そして録音した音声データの加工といった一連の流れを、理論と実践を交えながら体験することを目指します。

### このガイドで学べること
- 音声がデジタルデータになる仕組み（サンプリング、PCM）
- Pythonを使ったPCの音声入出力（録音・再生）
- 音声データの正体である「NumPy配列」の操作
- 音声の視覚化（波形表示）
- 音声の加工（音量調整、逆再生、速度変更）
- テキストからの音声合成と、音声のテキスト化（音声認識）

---

## 2. Windows向け環境構築

まず、このガイドで必要になるツールをすべてPCにセットアップします。この章の手順を完了させれば、あとの実践パートをスムーズに進めることができます。

### 2-1. Pythonライブラリのインストール

最初に、音声処理で使うPythonライブラリを`pip`コマンドで一括インストールします。
以下のコマンドを、お使いのPCのターミナル（コマンドプロンプトやPowerShell）にコピー＆ペーストして実行してください。

```bash
pip install sounddevice numpy matplotlib scipy pyopenjtalk vosk
```

#### 各ライブラリの詳細な役割

インストールした各ライブラリが、それぞれどのような役割を担っているのかを解説します。

- **`sounddevice`**: PCの音声入出力を担う「窓口」
  - PythonプログラムとPCのハードウェア（マイク、スピーカー）との間の橋渡しをします。`sounddevice`のおかげで、複雑なハードウェアの違いを意識することなく、簡単に録音や再生ができます。

- **`numpy`**: 音声データを格納・計算する「魔法の箱」
  - 音声データは、実際には膨大な数の数値の集まりです。`numpy`は、この数値データを「配列(Array)」という形で効率的に扱い、高速に計算するためのライブラリです。音声の加工は、このNumPy配列を操作することそのものです。

- **`matplotlib`**: 音声データを視覚化する「グラフ描画ツール」
  - ただの数値の羅列である音声データを、人間が直感的に理解できる「波形グラフ」として表示するために使います。

- **`scipy`**: 科学技術計算ライブラリ
  - 非常に多機能なライブラリですが、このガイドでは主に、録音した音声をWAVファイルとして保存したり、既存のWAVファイルを読み込んだりするために`scipy.io.wavfile`という機能を利用します。

- **`pyopenjtalk`**: 日本語の音声合成エンジン
  - `Open JTalk`という、オフラインで動作するフリーの日本語音声合成エンジンをPythonから簡単に使えるようにしたものです。これを使うと、プログラムに任意の日本語テキストを喋らせることができます。

- **`vosk`**: オフラインで使える音声認識エンジン
  - マイクから入力された人間の声を、テキストに変換するために使います。オフラインで動作するため、インターネット接続がなくても利用できるのが大きな特徴です。

### 2-2. 外部ツール `ffmpeg` のインストール

`ffmpeg`は、音声や動画のフォーマットを変換したり、編集したりするための非常に強力なコマンドラインツールです。例えば、録音したWAVファイルをMP3ファイルに変換する、といった用途で使います。これはPythonライブラリではないため、手動でPCにインストールする必要があります。

#### インストール手順

1.  **公式サイトからファイルをダウンロード**
    - [ffmpeg.orgのダウンロードページ](https://ffmpeg.org/download.html)にアクセスします。
    - Windowsのロゴアイコンにマウスを合わせ、表示されるリンク（例: `gyan.dev` や `BtbN`）のどちらかをクリックします。
    - `gyan.dev`の場合、「release builds」の中から `ffmpeg-release-full.7z` のような名前のファイルをダウンロードします。（`.7z`はzipと同様の圧縮ファイルです。展開できない場合は[7-Zip](https://www.7-zip.org/)などをインストールしてください）

2.  **ファイルを解凍して配置**
    - ダウンロードした圧縮ファイルを解凍します。
    - 解凍して出てきたフォルダ（例: `ffmpeg-6.0-full_build`）を、`C:\`ドライブ直下など、分かりやすい場所に移動させます。ここでは例として `C:\ffmpeg` にフォルダ名を変更して配置したとします。
    - `C:\ffmpeg` の中には `bin`, `doc`, `presets` といったフォルダがあるはずです。重要なのは **`bin`** フォルダです。

3.  **環境変数「PATH」を設定**
    - `ffmpeg`をコマンドプロンプトのどこからでも呼び出せるように、`bin`フォルダの場所をWindowsに教えてあげる必要があります。
    - Windowsの検索バーで「**環境変数を編集**」と入力し、「システム環境変数の編集」を開きます。
    - 「環境変数」ボタンをクリックします。
    - 「システム環境変数」のリストから `Path` という変数を見つけて選択し、「編集」ボタンをクリックします。
    - 「新規」ボタンを押し、先ほど配置した`ffmpeg`の`bin`フォルダへのフルパス（例: `C:\ffmpeg\bin`）を入力し、「OK」をすべてのウィンドウで押して閉じます。

4.  **インストールの確認**
    - **新しい**コマンドプロンプトを開き（既に開いているものはダメ）、以下のコマンドを実行します。
      ```bash
      ffmpeg -version
      ```
    - `ffmpeg version ...` というようにバージョン情報が表示されれば、インストールは成功です。

### 2-3. 音声認識モデル `Vosk` の準備

`vosk`ライブラリはそれ単体では音声を認識できません。「どの言語を認識するのか」を定義した**モデルファイル**が別途必要になります。

1.  **モデルのダウンロード**: 
    以下の公式サイトから、日本語モデルをダウンロードします。
    - **Vosk Models Page**: [https://alphacephei.com/vosk/models](https://alphacephei.com/vosk/models)
    - `vosk-model-ja-0.22` のような、日本語用のモデル（zipファイル）を見つけてダウンロードしてください。（ファイルサイズが1GB以上あるので注意してください）

2.  **モデルの配置**: 
    ダウンロードしたzipファイルを解凍し、出てきたフォルダ（例: `vosk-model-ja-0.22`）を、これから作成するPythonスクリプトと同じ階層（プロジェクトフォルダ）に置いてください。

これで、すべての環境構築が完了しました。

---

## 3. 音声データの基本（理論編）

（この章の内容は以前のバージョンと同じです）

---

## 4. 実践1: 録音と再生

（この章の内容は以前のバージョンと同じです。章番号のみ変更）

---

## 5. 実践2: 音声の可視化（波形表示）

（この章の内容は以前のバージョンと同じです。章番号のみ変更）

---

## 6. 実践3: 音声データの加工

（この章の内容は以前のバージョンと同じです。章番号のみ変更）

---

## 7. 実践4: テキストからの音声合成 (pyopenjtalk)

（この章の内容は以前のバージョンと同じです。章番号のみ変更）

---

## 8. 実践5: 音声認識 (Vosk)

（この章の内容は以前のバージョンと同じです。章番号のみ変更）

---

## 9. 次のステップへ

（この章の内容は以前のバージョンと同じです。章番号のみ変更）
